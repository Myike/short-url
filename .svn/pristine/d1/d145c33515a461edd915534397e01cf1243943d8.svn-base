package cn.com.yunyoutianxia.tour.utils;

import cn.com.yunyoutianxia.commons.util.MD5;


/**
 * @Author: zhiwutu
 * @Date: 2019/5/8 16:00
 * @Description: 短域名工具类
 */
public class ShortUrlUtil {

    //字符库
    private static String[] chars = new String[] { "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p",
            "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "A",
            "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V",
            "W", "X", "Y", "Z"
    };

    /**
     * @Description: 短域名生成算法
     *
     * @MethodName   shortUrl
     * @author      zhiwutu
     * @param longUrl
     * @return      java.lang.String
     * @date        2019/5/8 16:04
     */
    public static String shortUrl(String longUrl) {
        String encode = MD5.encryptPassword(longUrl);
        String[] restUrls = new String[4];
        for(int i = 0; i < 4; i++) {
            String substring = encode.substring(i * 8, i * 8 + 8);
            long  subLong = 0x3FFFFFFF & Long.parseLong(substring, 16);
            System.out.println("位置："+subLong);
            StringBuilder item = new StringBuilder();
            for (int j = 0; j < 6; j++) {
                long index = 0x0000003D & subLong;      // 把得到的值与 0x0000003D 进行位与运算，取得字符数组 chars 索引
                item.append(chars[(int) index]);        // 把取得的字符相加
                subLong = subLong >> 5;                 // 每次循环按位右移 5 位
            }
            restUrls[i] = item.toString();
        }
        return restUrls[0];
    }

}
